Here’s the full rundown of what we fixed / learned on the CyberPanel + OpenLiteSpeed side, in clean “tell Replit” bullets:

---

### What was wrong

* **docRoot was pointing to a non-existent folder** (`/client/dist`).
  Your actual build output was **not there**, so OLS served 404/default.
* Your real React/Vite build was located at:
  **`/home/digeratiexperts.com/public_html/dist/public/index.html`**
* **.htaccess wasn’t being applied** because:

  * it was in the wrong folder (not inside docRoot), and/or
  * OpenLiteSpeed sometimes ignores Apache-ish wrappers, and/or
  * **permissions/ownership blocked reads/writes** in `dist/public`.
* **Build output folders get recreated** on every `npm run build`, so any manual `.htaccess` placed directly in `dist/public` can disappear unless permissions are right or it’s copied in by the build.
* Portal subdomain was 404 because **its vhost didn’t have correct docRoot + SPA rewrites** (and had a docRoot syntax error).

---

### What we changed to get the **main site working**

1. **Set main domain docRoot to the real build folder**
   In digeratiexperts.com vHost Conf:

   ```
   docRoot /home/digeratiexperts.com/public_html/dist/public
   ```
2. **Enabled rewrite + htaccess loading in vhost**

   ```
   rewrite {
     enable 1
     autoLoadHtaccess 1
   }
   ```
3. **Put SPA rewrite rules inside the docRoot folder**
   File path:
   `/home/digeratiexperts.com/public_html/dist/public/.htaccess`

   Content that works on OLS:

   ```apache
   RewriteEngine On
   RewriteBase /
   RewriteRule ^index\.html$ - [L]
   RewriteCond %{REQUEST_FILENAME} !-f
   RewriteCond %{REQUEST_FILENAME} !-d
   RewriteRule . /index.html [L]
   ```
4. **Fixed permissions/ownership on dist/public**
   Because OLS runs as `nobody` and FileZilla couldn’t write there.
   We set:

   * folders **755**
   * files **644**
   * owned by `diger6692`

   (Otherwise OLS can’t read your real `index.html`/assets and falls back to CyberPanel stub.)
5. **Turned rewrite OFF inside ACME challenge context**
   So Let’s Encrypt renewal doesn’t break:

   ```
   context /.well-known/acme-challenge { rewrite { enable 0 } }
   ```
6. **Restarted OpenLiteSpeed after each vhost/rewrite change**
   “Graceful Restart / Restart lsws” is required or changes won’t apply.

---

### What we changed / need for **portal subdomain**

* Portal should **share the same build folder** unless you want a separate app.
* Portal vhost must also point to the same docRoot and have the same SPA rewrite.
* We found/fixed a syntax bug:
  portal vhost had **`docRoot docRoot ...`** (invalid).
  Needs to be a single docRoot line.
* Portal vhost rewrite block should use the same SPA rule as main.
* Restart lsws after saving portal vhost.

---

### Key takeaways for Replit build/deploy

* **CyberPanel docRoot must always match the build output path.**
* If Replit changes build output structure, docRoot must be updated.
* **SPA rewrite must live at vhost level or in docRoot/.htaccess.**
* **dist/public is volatile**; builds recreate it → any required file (like `.htaccess`) should be:

  * either handled in vhost rewriteRules, or
  * stored in Vite `public/` so it copies into the build, and
  * permissions must allow it to persist.

---

If you want, I can turn this into a short Replit-friendly “deployment SOP” text block you can paste into their project notes.
